---
title: "Windowsのエクスプローラーでフォルダを開くたびに新しいウィンドウが開いてしまうのを直す"
date: 2022-11-17T12:34:15+09:00
tags:
  - tech
  - Windows
---

Windows 11 のエクスプローラーにタブ機能がついたというので、 QTTabBar を無理矢理消したら、
フォルダをひらくたびにエクスプローラーのウィンドウが増殖する問題に悩まされた。

レジストリをいじれば一発で直る。
`HKEY_CLASSES_ROOT\Folder\shell` にある「（既定）」というやつに値が入っていたら、それを消せばいい。

`HKEY_CLASSES_ROOT` というのはファイルタイプの開き方を保存しているらしい。
Windows のことはよく知らないので雰囲気で書いているが、新しいウィンドウが開いてしまうのはフォルダを開いたときに
QTTabBar のルーチンが呼び出されるように設定されていることが原因のようだ。
QTTabBar はアンインストールされているので実際にはこの呼び出しは失敗するが、
そのフォールバックでエクスプローラーで開く（`explorer フォルダ` というコマンドを実行する）という動作になっているので、
毎回新しいウィンドウが開かれてしまっていたということのような気がする。
